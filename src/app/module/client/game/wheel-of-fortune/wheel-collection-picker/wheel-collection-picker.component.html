<div class="flex flex-col gap-5">
  @if (loading()) {
  <div class="flex justify-center items-center py-20">
    <mat-spinner diameter="50"></mat-spinner>
  </div>
  } @else if (loadingDishes()) {
  <div class="flex justify-center items-center py-20">
    <div class="flex flex-col items-center gap-4">
      <mat-spinner diameter="50"></mat-spinner>
      <p class="text-gray-200 text-lg" i18n>Loading collection dishes...</p>
    </div>
  </div>
  } @else {
    <!-- Collections Grid -->
    <div class="flex flex-col gap-4">
      <h2 class="text-gray-200 font-bold text-xl flex items-center gap-2">
        <mat-icon class="text-blue-400">collections_bookmark</mat-icon>
        <span i18n>My Collections</span>
      </h2>
      <p class="text-gray-400 text-sm" i18n>Click a collection to load its dishes to the wheel</p>
      
      @if (collections().length === 0) {
        <div class="glassmorphic-container_dark p-8 rounded-2xl">
          <app-empty></app-empty>
          <p class="text-center text-gray-400 mt-4" i18n>
            You don't have any dish collections yet. Create one to organize your favorite dishes!
          </p>
        </div>
      } @else {
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[70vh] overflow-y-auto rounded-lg p-1">
          @for (collection of collections(); track collection._id) {
            <mat-card 
              class="p-6 rounded-2xl cursor-pointer hover:scale-[1.02] transition-transform duration-200 border border-white/10 hover:border-white/20"
              (click)="selectCollection(collection)"
            >
              <div class="flex items-start gap-4">
                <!-- Icon -->
                <div 
                  class="w-14 h-14 rounded-xl flex items-center justify-center flex-shrink-0"
                  [style.background]="'linear-gradient(135deg, ' + getCollectionColor(collection.color) + ', ' + getCollectionColor(collection.color) + 'dd)'"
                >
                  <mat-icon class="text-white text-3xl">{{ getCollectionIcon(collection.icon) }}</mat-icon>
                </div>
                
                <!-- Content -->
                <div class="flex-1 min-w-0">
                  <h3 class="text-white font-bold text-lg mb-1 truncate">
                    {{ collection.name }}
                  </h3>
                  
                  @if (collection.description) {
                    <p class="text-gray-400 text-sm mb-2 line-clamp-2">
                      {{ collection.description }}
                    </p>
                  }
                  
                  <div class="flex items-center gap-3 text-sm">
                    <span class="flex items-center gap-1 text-blue-400">
                      <mat-icon class="!text-base">restaurant</mat-icon>
                      <span>{{ collection.dishSlugs.length || 0 }} <span i18n>dishes</span></span>
                    </span>
                    
                    @if (collection.occasion) {
                      <span class="flex items-center gap-1 text-purple-400">
                        <mat-icon class="!text-base">event</mat-icon>
                        <span>{{ collection.occasion | titlecase }}</span>
                      </span>
                    }
                  </div>
                  
                  @if (collection.tags && collection.tags.length > 0) {
                    <div class="flex flex-wrap gap-1 mt-2">
                      @for (tag of collection.tags.slice(0, 2); track tag) {
                        <span class="px-2 py-0.5 bg-white/10 text-gray-300 text-xs rounded-full">
                          {{ tag }}
                        </span>
                      }
                      @if (collection.tags.length > 2) {
                        <span class="px-2 py-0.5 bg-white/10 text-gray-300 text-xs rounded-full">
                          +{{ collection.tags.length - 2 }}
                        </span>
                      }
                    </div>
                  }
                </div>
                
                <mat-icon class="text-gray-400">chevron_right</mat-icon>
              </div>
            </mat-card>
          }
        </div>
      }
    </div>
  }
</div>
